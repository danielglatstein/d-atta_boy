function graphPitchesListener(){$("#pitchers").on("change",function(){$.ajax({url:"/pitches",type:"GET",dataType:"json",data:{pitcher_id:$("#pitchers").val()},complete:function(){},success:function(t,e,c){var a=t.pitches;graphPitches(a)},error:function(){}})})}function graphPitches(t,e){$("svg").remove();var c=d3.select("#batters-box").append("svg").attr("class","pitch_distribution").attr("width","450").attr("height","550"),a=d3.scale.linear().domain([200,20]).range([400,20]),n=d3.scale.linear().domain([200,20]).range([400,20]);c.selectAll("circle").data(t).enter().append("circle").attr("cx",function(t){return a(t.x)}).attr("cy",function(t){return n(t.y)}).attr("class",function(t){return t.type}).attr("r",4);var i=d3.svg.axis().scale(a).orient("bottom");c.append("g").attr("transform","translate(5,520)").call(i);var r=d3.svg.axis().scale(a).orient("top");c.append("g").attr("transform","translate(5,140)").call(r);var s=d3.svg.axis().scale(n).orient("left");c.append("g").attr("transform","translate(20,120)").call(s);var p=d3.svg.axis().scale(n).orient("right");c.append("g").attr("transform","translate(410,120)").call(p),buildPitchTypeList()}function buildPitchTypeList(t){pitchTypes=["FA","FF","FT","FC","FS","SL","CH","KC","KN","EP","SI","CU","CB"],$data_points=d3.selectAll("circle")[0];var e={};e.total=0;for(var c,a=0;a<$data_points.length;a++)c=$($data_points[a]).attr("class"),e[c]?(e[c]=e[c]+1,e.total=e.total+1):(e[c]=1,e.total=e.total+1);if(t)for(var a=0;a<t.length;a++)e[t[a]]&&delete e[t[a]];var n=[];Object.keys(e).forEach(function(t){hash={},hash.pitchType=t,hash.count=e[t],n.push(hash)});for(var a=0;a<pitchTypes.length;a++)e[pitchTypes[a]]?$("input[value='"+pitchTypes[a]+"']").prop("checked",!0):$("input[value='"+pitchTypes[a]+"']").prop("checked",!1);var i=d3.select("#pitch_type_list").append("table").attr("class","pitch_type_counts"),r=[{head:"Pitch Type",cl:"pitchType",html:\u0192("pitchType")},{head:"Count",cl:"count",html:\u0192("count")}];i.append("thead").append("tr").selectAll("th").data(r).enter().append("th").attr("class",\u0192("cl")).text(\u0192("head")),i.append("tbody").selectAll("tr").data(n).enter().append("tr").attr("class","matchup_row").selectAll("td").data(function(t,e){return r.map(function(c){var a={};return d3.keys(c).forEach(function(n){a[n]="function"==typeof c[n]?c[n](t,e):c[n]}),a})}).enter().append("td").html(\u0192("html")).attr("class",\u0192("cl")),$.each($($("td")),function(t,e){$(e).attr("class",$(e).text())})}function pitchTypeListListener(){$("#pitchers").on("change",function(){$("input[type='checkbox']").attr("checked",!1),buildPitchTypeList()}),$("").on("click",function(){$("."+$(this).attr("class")).toggle()})}function checkBoxListener(){$("input[type='checkbox']").on("click",function(){$("circle."+$(this).val()).toggle(),checkedPitches=[],p=$("input:checkbox:not(:checked)").slice(0,$("input:checkbox:not(:checked)").length),$.each(p,function(t,e){checkedPitches.push($(e).val())}),$("input[type='checkbox']").attr("checked",!1),buildPitchTypeList(checkedPitches)})}$(function(){graphPitchesListener(),pitchTypeListListener(),checkBoxListener()});